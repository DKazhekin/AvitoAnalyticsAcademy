from locust import HttpUser, task, between
import random


REAL_USER_IDS = [
        558,    2512,    2770,    2892,    3197,    4808,    5310,
          5884,    6155,    6445,    7164,    8405,    9195,   10561,
         11694,   14622,   14840,   16343,   16761,   18908,   18916,
         19150,   20547,   22340,   22447,   23492,   26392,  251690,
        251968,  252679,  253860,  254104,  254227,  254524,  255544,
        255598,  256266,  256454,  256585,  257032,  257594,  259697,
        260440,  261898,  262236,  264294,  264409,  265975,  269931,
        271665,  272253,  275333,  279258,  281031,  500030,  501668,
        501809,  502100,  502635,  503069,  503742,  505899,  506220,
        506406,  507001,  511491,  511586,  513621,  515789,  519373,
        519760,  523809,  523965,  524184,  535691,  750030,  750044,
        750463,  750510,  751035,  752476,  752968,  755878,  756480,
        756533,  757239,  758013,  758148,  758406,  758673,  759209,
        759819,  761290,  761712,  763872,  765964,  765999,  766967,
       1000362, 1000625, 1002897, 1004528, 1004868, 1005645, 1007640,
       1015709, 1017878, 1021494, 1250230, 1250238, 1250588, 1251582,
       1251791, 1252340, 1253291, 1253577, 1253726, 1253928, 1254142,
       1254333, 1254938, 1257818, 1258370, 1259055, 1259169, 1261030,
       1263900, 1264853, 1266335, 1268245, 1272672, 1501606, 1501803,
       1501969, 1503347, 1503550, 1505038, 1505943, 1506028, 1506802,
       1509867, 1510599, 1511020, 1512128, 1512478, 1513495, 1513919,
       1514008, 1514421, 1515258, 1516646, 1516961, 1517191, 1518122,
       1518703, 1518719, 1520343, 1521139, 1522768, 1523329, 1523863,
       1525058, 1527116, 1527483, 1527867, 1529415, 1529860, 1531931,
       1534307, 1534574, 1535504, 1536250, 1537182, 1537637, 1538106,
       1538294, 1538912, 1539350, 1541054, 1541413, 1544202, 1545272,
       1545966, 1548706, 1548856, 1548948, 1550241, 1554524, 1554941,
       1555091, 1555106, 1555829, 1558092, 1558476, 1560678, 1563938,
       1564410, 1567169, 1569061, 1569278, 1569392, 1572141, 1573319,
       1577015, 1577238, 1579170, 1582008, 1582825, 1582866, 1583485,
       1586714, 1586716, 1588737, 1594870, 1596313, 1597156, 1597185,
       1600172, 1601353, 1608470, 1611907, 1613751, 1616333, 1622364,
       1624682, 1628262, 1629155, 1633069, 1636026, 1636974, 1638653,
       1640804, 1642157, 1642236, 1648523, 1653139, 1657360, 1657951,
       1660835, 1662504, 1673819, 1674022, 1675571, 1676292, 1677347,
       1684576, 1684763, 1684849, 1686998, 1690314, 1697484, 1709389,
       1713989, 1716809, 1726681, 1732038, 1740304, 1751952, 1752200,
       1752373, 1753979, 1754154, 1754258, 1754492, 1755037, 1755794,
       1756317, 1757246, 1757387, 1759233, 1759697, 1760533, 1760795,
       1761635, 1762580, 1762741, 1763611, 1763661, 1764589, 1765189,
       1765888, 1768507, 1769886, 1770429, 1777947, 1778112, 1779952,
       1782250, 1782640, 1782914, 1784989, 1785098, 1786561, 1786941,
       1787534, 1788610, 1789121, 1789168, 1790000, 1790467
]

class RecommenderUser(HttpUser):
    wait_time = between(1, 3)
    
    def on_start(self):
        self.user_id = random.choice(REAL_USER_IDS)
    
    @task(3)
    def get_random_item(self):
        self.client.get("/item/random")
    
    @task(2)
    def get_item_by_id(self):
        item_id = random.randint(1, 10000)
        self.client.get(f"/item?item_id={item_id}")
    
    @task(2)
    def get_similar_items(self):
        item_id = random.randint(1, 10000)
        self.client.get(f"/similar/items?item_id={item_id}")
    
    @task(1)
    def get_user_by_id(self):
        user_id = random.choice(REAL_USER_IDS)
        self.client.get(f"/user?user_id={user_id}")
    
    @task(1)
    def get_random_user(self):
        self.client.get("/user/random")
    
    @task(2)
    def get_recommendation_for_user(self):
        user_id = random.choice(REAL_USER_IDS)
        self.client.get(f"/recommendation/item?user_id={user_id}", name="/recommendation/item")
    
    @task(1)
    def get_main_page(self):
        self.client.get("/")
    
    @task(1)
    def get_recommendation_page(self):
        self.client.get("/recommendation")
